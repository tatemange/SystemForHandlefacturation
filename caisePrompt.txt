# ğŸ¯ Objectif (module caisse)

DÃ©velopper **UNIQUEMENT le module CAISSE** de cette application de facturation. Le module doit gÃ©rer les encaissements, la validation des rÃ¨glements, la mise Ã  jour du solde/dette clients et la traÃ§abilitÃ© financiÃ¨re.

Base de donnÃ©es concernÃ©e : `CAISSE`, `REGLEMENT`, `ENREGISTRER`, `CLIENT`, `DOCUMENT`, `HISTORIQUE`.

---

## âœ… RÃ´les du module CAISSE

1ï¸âƒ£ Centraliser tous les paiements enregistrÃ©s par les utilisateurs.
2ï¸âƒ£ Permettre leur validation par une caisse.
3ï¸âƒ£ Mettre Ã  jour automatiquement :

* soldes et dettes clients
* statut des documents (factures)
  4ï¸âƒ£ Garantir une traÃ§abilitÃ© dans lâ€™historique financier.

---

## ğŸ§© FonctionnalitÃ©s Ã  implÃ©menter

### ğŸ”¹ Gestion des Caisses (Table CAISSE)

* CrÃ©er / modifier une caisse
* Associer un responsable
* Voir les rÃ¨glements liÃ©s Ã  une caisse

---

### ğŸ”¹ Traitement des Paiements

BasÃ© sur `REGLEMENT` + `ENREGISTRER`

Fonctionnement :

* Un paiement appartient Ã  un client
* Il doit obligatoirement passer par une caisse
* Statuts de ENREGISTRER :

  * EN_ATTENTE (par dÃ©faut)
  * VALIDE
  * ANNULE

RÃ¨gles :

* Quand VALIDÃ‰ â†’

  * mise Ã  jour solde client
  * mise Ã  jour dette client
  * mise Ã  jour statut document si concernÃ©
  * Ã©criture dans HISTORIQUE
* Quand ANNULÃ‰ â†’ rollback logique

Modes de paiement supportÃ©s :
CASH, MOBILE MONEY, CHEQUE, BANK_TRANSFER, AUTRE

---

### ğŸ”¹ Gestion des Documents de Facturation

BasÃ© sur `DOCUMENT`

* EN_COURS
* IMPAYE
* PAYE

RÃ¨gles :

* paiement total â†’ PAYE
* paiement partiel â†’ IMPAYE
* non payÃ© â†’ IMPAYE

---

### ğŸ”¹ Historique Financier (HISTORIQUE)

Chaque action financiÃ¨re doit Ãªtre enregistrÃ©e avec :

* type_action : CREDIT / DEBIT / ANNULATION
* commentaire
* solde aprÃ¨s opÃ©ration
* date automatique
* id_reglement si applicable

â— Ne jamais supprimer une ligne historique.

---

## âš–ï¸ Contraintes Logiques Importantes

* Un rÃ¨glement doit toujours Ãªtre liÃ© Ã  un client.
* Un rÃ¨glement validÃ© ne peut pas Ãªtre supprimÃ©.
* Validation caisse obligatoire.
* Toute annulation doit laisser une trace.
* Utiliser transactions pour Ã©viter incohÃ©rences financiÃ¨res.

---

## ğŸ“Š Rapports Minium Ã  Fournir

* total encaissÃ© par caisse
* total encaissÃ© par jour
* total par mode de paiement
* dettes clients restantes
* journal caisse

---

## ğŸ› ï¸ SpÃ©cifications Techniques

* Respect strict des contraintes SQL
* Mise Ã  jour automatique solde / dette / statuts
* SÃ©curiser lâ€™accÃ¨s selon rÃ´les (SUPER_ADMIN / ADMIN / GESTIONNAIRE)

---

## ğŸ§ª Tests Fonctionnels Obligatoires

* Paiement validÃ©
* Paiement annulÃ©
* Paiement partiel
* Mise Ã  jour document
* CohÃ©rence solde & dette
* Historique correct

---

Tu dois produire un module propre, structurÃ©, cohÃ©rent et sÃ©curisÃ©, prÃªt Ã  Ãªtre intÃ©grÃ© dans une application complÃ¨te de facturation.
